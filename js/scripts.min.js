var backToTop;window._app=angular.module("App",["ui.bootstrap","ngAnimate","ui.router","angular-loading-bar","wu.masonry","LocalStorageModule","ngSanitize"]),window._app.config(function(t,e,n,o,r){"use strict";t.startSymbol("{#"),t.endSymbol("#}"),e.defaults.headers.common["X-Requested-With"]="XMLHttpRequest",e.defaults.useXDomain=!0,o.includeSpinner=!1,r.setUrl({host:"http://xky3.ml/",path:"project",category:"category"})}),window._app.run(function(t,e,n,o,r,a,s){"use strict";t.$state=e,t.$stateParams=n,a.get(s.getCategoryUrl()).success(function(e){t.$categories=e.success.data}),t.$on("errorOccured",function(){$("body").addClass("error-occured")}),t.$on("cfpLoadingBar:loading",function(t){r.debug("cfpLoadingBar:loading",t),$("body").removeClass("error-occured")}),t.$on("cfpLoadingBar:started",function(t){r.debug("cfpLoadingBar:started",t),$("body").removeClass("error-occured")}),t.$on("cfpLoadingBar:completed",function(t){r.debug("cfpLoadingBar:completed",t),o._glitch.glitching()})}),backToTop=function(){var t;t={offset:$(window).height()/2,element:$("#backToTop"),duration:700},$(window).scroll(function(){return $(this).scrollTop()>t.offset?t.element.fadeIn():t.element.fadeOut()}),t.element.on("click",function(e){e.preventDefault(),$("body, html").animate({scrollTop:0},t.duration)})},angular.element(document).ready(function(){angular.bootstrap(document,["App"]),window._glitch=new GlitchFX("glitch_canvas","/images/logo.png")}),window._app.config(function(t,e){var n;n=window.location.origin+window.location.pathname,e.otherwise("/"),t.state("index",{url:"/",controller:"IndexController",views:{projects:{templateUrl:n+"views/index.html",controller:"ProjectController"}}}).state("project",{"abstract":!0,url:"/project",controller:"ProjectController",template:'<ui-view class="index-projects animate" />'}).state("project.view",{parent:"project",url:"/:productId",templateUrl:n+"views/view.html",controller:function(t,e){t.view(e.productId)}})}),_app.controller("IndexController",function(t,e,n,o,r){t.init=function(){r.debug("Checking $state...",e),r.debug("Checking location...",o.location)},t.init()}),_app.controller("ProjectController",function(t,e,n,o,r,a,s,i,l,c,u,d){t.projects=[],t.project={},t.status=i.getAllDefaultStatus(),t.getAllTimeout=null,t.getAllNextPageDelayTime=2e3,t.masonryOpts={transitionDuration:".4s",columnWidth:".masonry-sizer",percentPosition:!0,itemSelector:".masonry-brick",gutter:10},t.checking=function(){o.log("Checking $state...",r),o.log("Checking location...",n.location),t.switches(r.current.name)},t.mouseEnter=function(t){$(t.currentTarget).find(".description").slideDown(300,function(){$(this).find(".description-text").animate({opacity:1},300)})},t.mouseLeave=function(t){$(t.currentTarget).find(".description").slideUp(180,function(){$(this).find(".description-text").animate({opacity:0},200)})},t.switches=function(e){switch(e){case"index":t.gettingAll()}},t.pushToProjects=function(e){angular.forEach(e,function(e,n){t.projects.push(e)})},t.gettingAll=function(){var e;t.projects=[],t.status=i.statusWhenGettingAll(),e=["project_page","project_paginate_done","project_paginate_interrupted"],angular.forEach(e,function(t){l.remove(t)}),c(function(){t.getAll(1)},1500)},t.getAll=function(e){var n;n=d.getAll(),u.$broadcast("projects:all",{page:e}),t.status=i.statusWhenGetAll(),s._paginate(e,n).success(function(e){o.log("ProjectController@getAll",e),u.$broadcast("projects:all:success"),t.status.error=!1,l.set("project_page",e.success.data.current_page),Boolean(e.success.data.next_page_url)?r.is("index")?t.getAllTimeout=c(function(){t.getAll(e.success.data.current_page+1)},t.getAllNextPageDelayTime):l.set("project_paginate_interrupted",!0):(u.$broadcast("projects:all:complete"),t.status.loading=!1,l.set("project_paginate_done",!0))}).error(function(e){o.error("ProjectController@getAll::error",e),u.$broadcast("projects:all:error"),u.$broadcast("errorOccured"),t.status=i.statusWhenError(e.error.message)}).then(function(e){t.pushToProjects(e.data.success.data.data),t.status.loadingFirstTime=!1})},t.checking()}),_app.factory("$helpers",function(t){var e;return e={},e.getAllDefaultStatus=function(){return{loading:!1,error:!1,errorMessage:null,loadingFirstTime:!1}},e.getAllDefaultTimeout=function(){return{gettingAll:null,nextPage:3e3}},e.statusWhenGettingAll=function(){return{loadingFirstTime:!0,error:!1}},e.statusWhenGetAll=function(){return{loading:!0,error:!1}},e.statusWhenSuccess=function(){return{error:!1}},e.statusWhenNoMoreNextPage=function(){return{loading:!1}},e.statusWhenError=function(t){return{error:!0,loading:!1,errorMessage:t}},e.statusWhenComplete=function(){return{loadingFirstTime:!1}},e}),_app.factory("$req",function(t){var e;return e={},e._paginate=function(e,n,o){return angular.isObject(e)&&(n=e.url,e=e.page,o=e.method),t({url:n,method:o?o:"GET",params:{page:e}})},e._post=function(e,n,o,r){return angular.isObject(e)&&(e=e.url,n=e.data,o=e.params,r=e.method),t({url:e,data:n,params:o,method:r?r:"POST"})},e._delete=function(t,n,o){return angular.isObject(t)&&(t=t.url,n=t.data,o=t.params),e._post(t,n,o,"DELETE")},e._patch=function(t,n,o){return angular.isObject(t)&&(t=t.url,n=t.data,o=t.params),e._post(t,n,o,"PATCH")},e._put=function(t,n,o){return angular.isObject(t)&&(t=t.url,n=t.data,o=t.params),e.post(t,n,o,"PUT")},e._get=function(e,n){return angular.isObject(e)&&(e=e.url,n=e.params),t({url:e,params:n,method:"GET"})},e}),_app.filter("sanitize",function(t){return function(e){return t.trustAsHtml(e)}});var GlitchFX;GlitchFX=function(){"use strict";function t(t,e){t=t?t:"glitch_canvas",e=e?e:"/images/logo.png",this.img=new Image,this.img.src=e,this.canvas=document.getElementById(t),this.context=this.canvas.getContext("2d"),this.img.onload=function(t){return function(){t.glitching()}}(this)}return t.canvas,t.context,t.img,t.offset=void 0,t.w=void 0,t.h=void 0,t.glitchInterval=void 0,t.prototype.glitching=function(){this.canvas.width=this.w=$(window).width(),this.offset=.1*this.w,this.canvas.height=this.h=~~(175*(this.w-2*this.offset)/this.img.width),$(window).resize(function(t){return function(){t.canvas.width=t.w=$(window).width(),t.offset=.1*t.w,t.canvas.height=t.h=~~(175*(t.w-2*t.offset)/t.img.width)}}(this)),clearInterval(this.glitchInterval),this.glitchInterval=setInterval(function(t){return function(){t.clear(),t.context.drawImage(t.img,0,110,t.img.width,175,t.offset,0,t.w-2*t.offset,t.h),setTimeout(function(){t.glitchImg(t.context,t.canvas)},t.randInt(250,1e3))}}(this),500)},t.prototype.glitchImg=function(t,e){var n,o,r,a,s,i,l;for(r=0,n=this.randInt(1,13),o=this.randInt(5,this.h/3);n>r;)i=Math.random()*this.w,l=Math.random()*this.h,s=this.w-i,a=o,t.drawImage(e,0,l,s,a,i,l,s,a),t.drawImage(e,s,l,i,a,0,l,i,a),r++},t.prototype.randInt=function(t,e){return~~(Math.random()*(e-t)+t)},t.prototype.clear=function(){this.context.rect(0,0,this.w,this.h),this.context.fill()},t}(),function(t){t(document).ready(function(){var e;e=t(window).width(),481>e?t("html").addClass("m320").removeClass("m768").removeClass("desktop").removeClass("m480"):739>e?t("html").addClass("m768").removeClass("desktop").removeClass("m320").removeClass("tablet"):970>e?t("html").addClass("tablet").removeClass("desktop").removeClass("m320").removeClass("m768"):e>971&&t("html").addClass("desktop").removeClass("m320").removeClass("m768").removeClass("tablet"),650>e&&t("html").addClass("mobile-menu").removeClass("desktop-menu"),e>651&&t("html").addClass("desktop-menu").removeClass("mobile-menu")}),t(window).resize(function(){var e;e=t(window).width(),481>e?t("html").addClass("m320").removeClass("m768").removeClass("desktop").removeClass("tablet"):669>e?t("html").addClass("m768").removeClass("desktop").removeClass("m320").removeClass("tablet"):970>e?t("html").addClass("tablet").removeClass("desktop").removeClass("m320").removeClass("m768"):e>971&&t("html").addClass("desktop").removeClass("m320").removeClass("m768").removeClass("tablet"),650>e&&t("html").addClass("mobile-menu").removeClass("desktop-menu"),e>651&&t("html").addClass("desktop-menu").removeClass("mobile-menu")})}(jQuery),_app.provider("Project",function(){var t,e,n;return e=void 0,n=void 0,t=void 0,{setUrl:function(o){e=o.host,n=o.path,t=o.category},setCategoryPath:function(e){t=e},$get:function(){return{host:e,path:n,getCategoryUrl:function(){return e+t},getUrl:function(){return e+n},getHost:function(){return e},getPath:function(){return n},getAll:function(){return e+n},view:function(t){return e+n+t}}}}});